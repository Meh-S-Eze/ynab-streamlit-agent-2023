---
description: AI Transaction Tagging System
globs: core/pydantic_ai_transaction_parser.py,core/shared_models.py,core/ynab_client.py,cli/natural_language_cli.py,core/transaction_*.py,core/date_utils.py
alwaysApply: true
---
# AI Transaction Tagging System
# This file documents the implementation of the AI transaction tagging system
# and establishes guidelines to preserve this functionality.

feature:
  name: "AI Transaction Tagging"
  description: "System that marks transactions processed by AI in the memo field"
  priority: "high"
  status: "implemented"

implementation:
  # Core implementation details
  format: "[AI {action_type} {date}]"
  location: "Prepended to the transaction memo field"
  action_types:
    - "Created" # For new transactions
    - "Modified" # For existing transactions that were updated
  date_format: "YYYY-MM-DD"

code_location:
  primary: "core/pydantic_ai_transaction_parser.py"
  
implementation_details: |
  The system prepends a tag to the memo field of any transaction created or modified by AI.
  The tag includes:
    1. An [AI] prefix to clearly identify AI involvement
    2. The specific action taken (Created/Modified)
    3. The date when the AI action occurred
  
  Example: "[AI Created 2025-03-04] Original memo text"

guidelines:
  # Rules for maintaining this functionality
  - "Always preserve the AI tagging system when modifying transaction processing code."
  - "Maintain the format '[AI {action_type} {date}]' for consistency and parsing."
  - "Do not remove or alter the detection of creation vs modification logic."
  - "When enhancing the system, extend rather than replace the existing tagging format."
  - "Keep the tag at the beginning of the memo field for visibility and consistent parsing."

testing:
  # How to verify the functionality is working
  - "Process transactions via natural language CLI and verify the memo field contains the AI tag."
  - "Verify both 'Created' and 'Modified' actions are correctly identified in the tag."
  - "Check that the date in the tag matches the current system date, not the transaction date."

impact:
  - Provides transparency about AI involvement in transaction management
  - Helps users distinguish between manually entered and AI-processed transactions
  - Creates an audit trail for AI activities within the budgeting system
  - Enables filtering of AI-generated transactions in the YNAB interface 